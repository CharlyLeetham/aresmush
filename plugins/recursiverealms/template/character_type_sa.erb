<%= line_with_text t('RecursiveRealms.char_sa_title', :chartype => self.chartypetitle) %>
<%= left("%xhDescription:%xn #{chartype['Descriptor']}", 100) %>

<% @chartype['Tiers'].each do |tier, attrib| %>
  <%= left("%xh#{tier}:%xn", 100) %>
  <% attrib.each do |attribute_name, attribute_value| %>
    <% if attribute_name == 'Special Abilities' %>
      <%= left("%xh#{attribute_name}:%xn", 100) %>
      <% attribute_value.each do |item| %>
        <% if item.is_a?(Hash) %>
          <% item.each do |key, val| %>
            <% if val.is_a?(Hash) %>
              <%= left("%xh#{key}:%xn", 100) %>
              <% val.each do |sub_key, sub_val| %>
                <%= left("  %xh#{sub_key}:%xn #{sub_val}", 100) %>
              <% end %>
            <% elsif val.is_a?(Array) %>
              <%= left("%xh#{key}:%xn", 100) %>
              <% val.each do |array_item| %>
                <%= left("  - #{array_item}", 100) %>
              <% end %>
            <% else %>
              <%= left("%xh#{key}:%xn #{val}", 100) %>
            <% end %>
          <% end %>
        <% elsif item.is_a?(Array) %>
          <% item.each do |array_item| %>
            <%= left("- #{array_item}", 100) %>
          <% end %>
        <% else %>
          <%= left("#{item}", 100) %>
        <% end %>
      <% end %>
      
    <% end %>
  <% end %>

<% end %>

<%= footer %>